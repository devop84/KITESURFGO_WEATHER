<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="nav">
        <div class="logo">
            <img src="img/logo_inverted.svg" alt="">
            <h1>kitesurfgo</h1>
        </div>
    </div>
    <div class="weather">
        
        <div class="location">
            <img id="condition_icon" src="img/113.webp" alt="">
            <h2 id="location_name"></h2>
            <i class="material-symbols-outlined" id="toggle-select-location">explore</i>
        </div>
        <div class="select-location">
            <div class="form">
                <i class="material-symbols-outlined" id="my_location">my_location</i>
                <input type="text" id="input_location" value="" placeholder="city name or gps coordinates">
                <i class="material-symbols-outlined submit_location" id="submit_location">check_circle</i>
            </div>
        </div>
        <div class="wind">
            <div class="wind-direction">
                <i class="material-symbols-outlined" id="wind_arrow">south_west</i>
                <h3 id="wind_dir"></h3>
            </div>
            <div class="wind-speed">
                <i class="material-symbols-outlined">arrow_drop_up</i>
                <h3 id="wind_kn"></h3>
            </div>
        </div>







        
        <canvas id="tide-chart"></canvas>
        <script>
          function getTideHeight(tideData, datetimeStr) {
            const datetime = new Date(datetimeStr);
            for (let i = 0; i < tideData.length - 1; i++) {
              const currentTide = tideData[i];
              const nextTide = tideData[i + 1];
              const currentTideTime = new Date(currentTide.datetime);
              const nextTideTime = new Date(nextTide.datetime);
              if (currentTideTime <= datetime && datetime < nextTideTime) {
                // Interpolate tide height using a sinusoidal function between two neighboring tides
                const timeDiff = nextTideTime - currentTideTime;
                const heightDiff = nextTide.height - currentTide.height;
                const timeSinceLastTide = datetime - currentTideTime;
                const fractionOfTime = timeSinceLastTide / timeDiff;
                const tideHeight = currentTide.height + heightDiff * (Math.sin(Math.PI * fractionOfTime - Math.PI / 2) + 1) / 2;
                return tideHeight;
              }
            }
            // If the datetime is after the last tide, return the height of the last tide
            return tideData[tideData.length - 1].height;
          }
      
          const tideData = [
            {
              "timestamp": 1682204552,
              "height": -1.7772909106,
              "state": "LOW TIDE",
              "datetime": "2023-04-22T23:02:32+00:00"
            },
            {
              "timestamp": 1682227303,
              "height": 1.5390116396,
              "state": "HIGH TIDE",
              "datetime": "2023-04-23T05:21:43+00:00"
            },
            {
              "timestamp": 1682248693,
              "height": -1.5165860946,
              "state": "LOW TIDE",
              "datetime": "2023-04-23T11:18:13+00:00"
            },
            {
              "timestamp": 1682271166,
              "height": 1.5183191763,
              "state": "HIGH TIDE",
              "datetime": "2023-04-23T17:32:46+00:00"
            },
            {
              "timestamp": 1682204552,
              "height": -1.7772909106,
              "state": "LOW TIDE",
              "datetime": "2023-04-24T01:02:32+00:00"
            }
          ];
      
          const labels = [];
          const data = [];
      
          // Generate tide height data for each hour of the day
          for (let i = 0; i < 24 * 60; i++) {
        const datetime = new Date(`2023-04-23T${Math.floor(i / 60).toString().padStart(2, "0")}:${(i % 60).toString().padStart(2, "0")}:00+00:00`);
        const tideHeight = getTideHeight(tideData, datetime.toISOString());
        labels.push(`${Math.floor(i / 60).toString().padStart(2, "0")}:${(i % 60).toString().padStart(2, "0")}`);
        data.push(tideHeight);
      }
      
          const ctx = document.getElementById('tide-chart').getContext('2d');
          const chart = new Chart(ctx, {
            type: 'line',
            data: {
              labels: labels,
              datasets: [{
                label: 'Tide Height',
                data: data,
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
              }]
            },
            options: {
              scales: {
                x: {
                  ticks: {
                    display: true
                  },
                  grid: {
                    display: false
                  }
                },
                y: {
                  ticks: {
                    display: true
                  }
                }
              },
              plugins: {
                title: {
                  display: false
                },
                legend: {
                  display: false
                },
                gridLines: {
                  display:false
                }
              }
            }
          });
      </script>
          
          


        




        <!-- <div class="tides">
            <div class="levels">
                <h3>HIGH</h3>
                <table>
                    <tr>
                        <td>0:30</td><td>5.8m</td>
                    </tr>
                    <tr>
                        <td>12:28</td><td>5.9m</td>
                    </tr>
                </table>
            </div>
            <div class="moon"><i class="material-symbols-outlined">stroke_full</i></div>
            <div class="levels">
                <h3>LOW</h3>
                <table>
                    <tr>
                        <td>0:30</td><td>5.8m</td>
                    </tr>
                    <tr>
                        <td>12:28</td><td>5.9m</td>
                    </tr>
                </table>
            </div>
        </div> -->
        <div class="time">
            <h4 id="last_update"></h4>
            <i class="material-symbols-outlined refresh" id="refresh_location">refresh</i>
        </div>
    </div>
</body>
</html>
<script src="script.js"></script>



